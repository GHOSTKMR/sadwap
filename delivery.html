<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Location Distance Chart - Kudu KS 29 Jazan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script> <!-- SheetJS for Excel Export -->
    <style>
        body { background-color: #f8f9fa; }
        .container { margin-top: 20px; }
        #chart-container { width: 100%; max-width: 900px; margin: auto; }
        h2 { text-align: center; font-weight: bold; margin-bottom: 20px; }
        .btn-container { text-align: right; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="btn-container">
        <button class="btn btn-primary" onclick="toggleLanguage()">üåç Translate</button>
        <button class="btn btn-success" onclick="exportToExcel()">üì• Export to Excel</button>
    </div>

    <h2 id="heading">Location Distance Chart from the Store Kudu KS 29 Jazan</h2>

    <div id="chart-container">
        <canvas id="distanceChart"></canvas>
    </div>

    <input type="text" id="searchInput" class="form-control mt-4 mb-3" placeholder="Search for a location..." onkeyup="filterTable()">

    <div class="table-responsive">
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th id="locationHeader">Location</th>
                    <th id="distanceHeader">Distance (km)</th>
                </tr>
            </thead>
            <tbody id="locationsTable">
                <!-- Table Data will be added dynamically -->
            </tbody>
        </table>
    </div>
</div>

<script>
    let isArabic = false;

    const locations = [
        { name_en: "EL OMIS HOSPITAL", name_ar: "ŸÖÿ≥ÿ™ŸàÿµŸÅ ÿßŸÑÿ£ŸàŸÖŸäÿ≥ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 5.3 },
        { name_en: "Mokhatat king fahad", name_ar: "ŸÖÿÆÿ∑ÿ∑ ÿßŸÑŸÖŸÑŸÉ ŸÅŸáÿØ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 18.8 },
        { name_en: "Mokhatat Al Mohamadeia", name_ar: "ŸÖÿÆÿ∑ÿ∑ ÿßŸÑŸÖÿ≠ŸÖÿØŸäÿ© - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 3.8 },
        { name_en: "MokhtatIbn al-Haytham", name_ar: "ŸÖÿÆÿ∑ÿ∑ ÿßŸÑÿ≠ÿ≥ŸÜ ÿ®ŸÜ ÿßŸÑŸáŸäÿ´ŸÖ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 12.1 },
        { name_en: "al maabooj", name_ar: "ŸÇÿ±Ÿäÿ© ÿßŸÑŸÖÿπÿ®Ÿàÿ¨", distance: 9.6 },
        { name_en: "al kwamlah", name_ar: "ŸÇÿ±Ÿäÿ© ÿßŸÑŸÉŸàÿßŸÖŸÑÿ©", distance: 18.4 },
        { name_en: "al karbos", name_ar: "ŸÇÿ±Ÿäÿ© ÿßŸÑŸÉÿ±ÿ®Ÿàÿ≥", distance: 11.2 },
        { name_en: "dhamad", name_ar: "ŸÇÿ±Ÿäÿ© ÿ∏ŸÖÿØ", distance: 41.9 },
        { name_en: "sebiah", name_ar: "ŸÇÿ±Ÿäÿ© ÿµÿ®Ÿäÿß - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 39.9 },
        { name_en: "dawar altawhed", name_ar: "ÿØŸàÿßÿ± ÿßŸÑÿ™Ÿàÿ≠ŸäÿØ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 2.5 },
        { name_en: "Dehayka", name_ar: "ÿØÿ≠ŸäŸÇÿ© - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 11.7 },
        { name_en: "mokhatat 8", name_ar: "ÿ≠Ÿä ŸÖÿÆÿ∑ÿ∑ 8", distance: 7.6 },
        { name_en: "mokhatat 7", name_ar: "ÿ≠Ÿä ŸÖÿÆÿ∑ÿ∑ 7", distance: 9.4 },
        { name_en: "mokhatat 6", name_ar: "ÿ≠Ÿä ŸÖÿÆÿ∑ÿ∑ 6", distance: 5.8 },
        { name_en: "mokhatat 5", name_ar: "ÿ≠Ÿä ŸÖÿÆÿ∑ÿ∑ 5", distance: 4 },
        { name_en: "al naseem", name_ar: "ÿ≠Ÿä ÿßŸÑŸÜÿ≥ŸäŸÖ", distance: 13 },
        { name_en: "al mataar", name_ar: "ÿ≠Ÿä ÿßŸÑŸÖÿ∑ÿßÿ± ÿ¨ÿßÿ≤ÿßŸÜ", distance: 7.6 },
        { name_en: "safa", name_ar: "ÿ≠Ÿä ÿßŸÑÿµŸÅÿß", distance: 7 },
        { name_en: "al shamia", name_ar: "ÿ≠Ÿä ÿßŸÑÿ¥ÿßŸÖŸäÿ©", distance: 2.3 },
        { name_en: "al swees", name_ar: "ÿ≠Ÿä ÿßŸÑÿ≥ŸàŸäÿ≥", distance: 6 },
        { name_en: "al sooq al dakhely", name_ar: "ÿ≠Ÿä ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿØÿßÿÆŸÑŸä", distance: 2.4 },
        { name_en: "al - rawdah", name_ar: "ÿ≠Ÿä ÿßŸÑÿ±Ÿàÿ∂ÿ©", distance: 2.6 },
        { name_en: "al defaa", name_ar: "ÿ≠Ÿä ÿßŸÑÿØŸÅÿßÿπ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 2.3 },
        { name_en: "GIZAN", name_ar: "ÿ¨Ÿäÿ≤ÿßŸÜ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 2.8 },
        { name_en: "Balad", name_ar: "ÿ®ŸÑÿØ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 3.6 },
        { name_en: "INDUSTRIAL AREA", name_ar: "ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿµŸÜÿßÿπŸäÿ© - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 13.4 },
        { name_en: "king fahad", name_ar: "ÿßŸÑŸÖŸÑŸÉ ŸÅŸáÿØ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 38.2 },
        { name_en: "AL SHATI", name_ar: "ÿßŸÑÿ¥ÿßÿ∑ÿ¶ - ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàÿµŸäŸÑ", distance: 6.8 },
        { name_en: "al rawabi", name_ar: "ÿßŸÑÿ±Ÿàÿßÿ®Ÿä", distance: 12.4 },
        { name_en: "abo areesh", name_ar: "ÿßÿ®Ÿà ÿπÿ±Ÿäÿ¥", distance: 35.7 },
        { name_en: "Al Qalaa", name_ar: "ÿ≠Ÿä ÿßŸÑŸÇŸÑÿπÿ©", distance: 3.5 },
        { name_en: "Al Jabal", name_ar: "ÿ≠Ÿä ÿßŸÑÿ¨ÿ®ŸÑ", distance: 2.5 },
        { name_en: "al mahliah", name_ar: "ŸÇÿ±Ÿäÿ© ÿßŸÑŸÖÿ≠ŸÑŸäÿ©", distance: 13.4 }
    ];

    function populateTable() {
        const tableBody = document.getElementById("locationsTable");
        tableBody.innerHTML = "";
        locations.forEach(location => {
            let name = isArabic ? location.name_ar : location.name_en;
            let distance = isArabic ? convertToArabicNumbers(location.distance) : location.distance;
            tableBody.innerHTML += `<tr><td>${name}</td><td>${distance}</td></tr>`;
        });
    }

    function convertToArabicNumbers(number) {
        return number.toString().replace(/\d/g, d => "Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©"[d]);
    }

    function toggleLanguage() {
        isArabic = !isArabic;
        document.getElementById("heading").innerText = isArabic ? "ŸÖÿÆÿ∑ÿ∑ ÿßŸÑŸÖÿ≥ÿßŸÅÿßÿ™ ŸÖŸÜ ŸÖÿ™ÿ¨ÿ± ŸÉŸàÿØŸà KS 29 ÿ¨ÿßÿ≤ÿßŸÜ" : "Location Distance Chart from the Store Kudu KS 29 Jazan";
        populateTable();
        drawChart();
    }

    function drawChart() {
        new Chart(document.getElementById("distanceChart"), {
            type: "bar",
            data: {
                labels: locations.map(l => isArabic ? l.name_ar : l.name_en),
                datasets: [{ label: "Distance (km)", data: locations.map(l => l.distance), backgroundColor: "blue" }]
            }
        });
    }

    function exportToExcel() {
        let data = [["Location", "Distance (km)"]];
        locations.forEach(location => {
            let name = isArabic ? location.name_ar : location.name_en;
            let distance = isArabic ? convertToArabicNumbers(location.distance) : location.distance;
            data.push([name, distance]);
        });

        let ws = XLSX.utils.aoa_to_sheet(data);
        let wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Locations");
        XLSX.writeFile(wb, "locations.xlsx");
    }

    document.addEventListener("DOMContentLoaded", () => { populateTable(); drawChart(); });
</script>

</body>
</html>
